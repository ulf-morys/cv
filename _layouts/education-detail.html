---
layout: default
---

<!-- Embed YAML data for detail page -->
<script>
// Ensure site data is available for detail pages
if (!window.siteData) {
    console.log('Embedding YAML data for education detail page...');
    try {
        window.siteData = {
            en: {{ site.data.en.content | jsonify }},
            de: {{ site.data.de.content | jsonify }},
            fr: {{ site.data.fr.content | jsonify }}
        };
        console.log('Education detail page YAML data embedded successfully');
    } catch (error) {
        console.error('Error embedding YAML data in education detail page:', error);
        window.siteData = null;
    }
}
</script>

<article class="education-detail">
    <div class="detail-container">
        <!-- Breadcrumb -->
        <nav class="breadcrumb" id="breadcrumb">
            <a href="/" data-nav="home">Home</a>
            <span class="breadcrumb-separator">/</span>
            <span data-nav="education">Education</span>
            <span class="breadcrumb-separator">/</span>
            <span class="current">{{ page.title | default: "Achievement" }}</span>
        </nav>

        <!-- Back Button -->
        <div class="detail-nav">
            <button class="btn-back" onclick="history.back()" id="backBtn">
                ← Back
            </button>
        </div>

        <!-- Achievement Header -->
        <header class="achievement-header" id="achievementHeader">
            <!-- Content loaded dynamically -->
        </header>

        <!-- Achievement Content -->
        <section class="achievement-content" id="achievementContent">
            <!-- Content loaded dynamically -->
        </section>

        <!-- Navigation Between Achievements -->
        <nav class="achievement-nav" id="achievementNav">
            <!-- Navigation loaded dynamically -->
        </nav>
    </div>
</article>

<script>
    // Initialize education detail page
    function initEducationDetailPage() {
        console.log('Initializing education detail page...');

        const urlPath = window.location.pathname;
        const achievementId = urlPath.split('/').filter(Boolean).pop();

        console.log('Education detail init:', {
            urlPath: urlPath,
            achievementId: achievementId,
            siteDataAvailable: !!window.siteData,
            globalFunctionsAvailable: {
                getCurrentLanguage: typeof getCurrentLanguage,
                loadContentData: typeof loadContentData
            }
        });

        if (achievementId) {
            loadEducationDetail(achievementId);
        } else {
            console.error('No achievement ID found in URL');
            // Redirect to home if no valid achievement ID
            const baseUrl = document.querySelector('meta[name="base-url"]')?.content || '';
            window.location.href = baseUrl + '/';
        }
    }

    document.addEventListener('DOMContentLoaded', function() {
        // Wait a bit for main.js to load global functions
        setTimeout(initEducationDetailPage, 100);
    });

    async function loadEducationDetail(achievementId) {
        try {
            const currentLang = getCurrentLanguage();
            let data;

            // Use embedded data if available, otherwise fallback to API
            if (window.siteData && window.siteData[currentLang]) {
                data = window.siteData[currentLang];
            } else {
                data = await loadContentData(currentLang);
            }

            const achievement = data.academic_achievements.find(ach => ach.id === achievementId);

            if (!achievement) {
                // Achievement not found, redirect to home
                window.location.href = '/';
                return;
            }

            renderEducationDetail(achievement, data);
        } catch (error) {
            console.error('Error loading education detail:', error);
            showError('Failed to load achievement details');
        }
    }

    function renderEducationDetail(achievement, data) {
        // Update page title
        document.title = `${achievement.degree_type} at ${achievement.institution} - ${data.site?.title || 'Ulf Morys'}`;

        // Render header
        const headerHtml = `
            <div class="institution-logo">
                <img src="${achievement.logo}" alt="${achievement.institution} logo" onerror="this.style.display='none'">
            </div>
            <div class="achievement-info">
                <h1>${achievement.course_title}</h1>
                <h2>${achievement.institution}</h2>
                <p class="location">${achievement.location}</p>
                <p class="duration">${achievement.duration}</p>
                <p class="degree-type">${achievement.degree_type}</p>
                ${achievement.grade ? `<p class="grade">Grade: ${achievement.grade}</p>` : ''}
            </div>
        `;
        document.getElementById('achievementHeader').innerHTML = headerHtml;

        // Render content
        const contentHtml = `
            <div class="achievement-description">
                <h3>Description</h3>
                <p>${achievement.description}</p>
            </div>

            <div class="achievement-details">
                <h3>Details</h3>
                <div class="detail-grid">
                    <div class="detail-item">
                        <span class="detail-label">Institution:</span>
                        <span class="detail-value">${achievement.institution}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Location:</span>
                        <span class="detail-value">${achievement.location}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Type:</span>
                        <span class="detail-value">${achievement.degree_type}</span>
                    </div>
                    ${achievement.grade ? `
                    <div class="detail-item">
                        <span class="detail-label">Grade:</span>
                        <span class="detail-value">${achievement.grade}</span>
                    </div>
                    ` : ''}
                    <div class="detail-item">
                        <span class="detail-label">Completed:</span>
                        <span class="detail-value">${achievement.end_date}</span>
                    </div>
                </div>
            </div>
        `;
        document.getElementById('achievementContent').innerHTML = contentHtml;

        // Render navigation
        renderAchievementNavigation(achievement, data.academic_achievements);
    }

    function renderAchievementNavigation(currentAchievement, allAchievements) {
        const currentIndex = allAchievements.findIndex(ach => ach.id === currentAchievement.id);
        const prevAchievement = currentIndex > 0 ? allAchievements[currentIndex - 1] : null;
        const nextAchievement = currentIndex < allAchievements.length - 1 ? allAchievements[currentIndex + 1] : null;

        let navHtml = '<div class="achievement-nav-links">';
        const baseUrl = document.querySelector('meta[name="base-url"]')?.content || '';

        if (prevAchievement) {
            navHtml += `
                <a href="${baseUrl}/education/${prevAchievement.id}/" class="nav-prev">
                    <span class="nav-direction">← Previous</span>
                    <span class="nav-title">${prevAchievement.degree_type}</span>
                    <span class="nav-institution">${prevAchievement.institution}</span>
                </a>
            `;
        }

        if (nextAchievement) {
            navHtml += `
                <a href="${baseUrl}/education/${nextAchievement.id}/" class="nav-next">
                    <span class="nav-direction">Next →</span>
                    <span class="nav-title">${nextAchievement.degree_type}</span>
                    <span class="nav-institution">${nextAchievement.institution}</span>
                </a>
            `;
        }

        navHtml += '</div>';

        document.getElementById('achievementNav').innerHTML = navHtml;
    }
</script>